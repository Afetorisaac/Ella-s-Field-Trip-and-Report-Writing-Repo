<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Procurement Demo</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;margin:20px}
    .card{border:1px solid #ccc;padding:12px;margin-bottom:12px;border-radius:6px}
  </style>
</head>
<body>
  <h1>Procurement Demo</h1>
  <div>
    <label>Requester: <input id="requester" value="Nurse A"></label><br>
    <label>Department: <input id="department" value="Ward 1"></label><br>
    <label>Item name: <input id="item_name" value="Vital Signs Monitor"></label><br>
    <label>Quantity: <input id="quantity" type="number" value="1"></label><br>
    <label>Justification:<br><textarea id="justification">Replace faulty unit</textarea></label><br>
    <button id="submitBtn">Submit Request</button>
  </div>
  <h2>Requests</h2>
  <div id="list"></div>

<script>
const API = 'http://127.0.0.1:5000/api/requests';
async function load(){
  const res = await fetch(API);
  const data = await res.json();
  const list = document.getElementById('list');
  list.innerHTML = '';
  data.forEach(r=>{
    const el = document.createElement('div'); el.className='card';
    el.innerHTML = `<b>${r.item_name}</b> (${r.quantity}) - ${r.status}<br>Requester: ${r.requester} | Dept: ${r.department}<br>${r.justification}`;
    list.appendChild(el);
  })
}

document.getElementById('submitBtn').addEventListener('click', async ()=>{
  const payload = {
    requester: document.getElementById('requester').value,
    department: document.getElementById('department').value,
    item_name: document.getElementById('item_name').value,
    quantity: parseInt(document.getElementById('quantity').value,10)||1,
    justification: document.getElementById('justification').value
  };
  const res = await fetch(API,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
  if(res.status===201){ load(); } else { alert('Error'); }
});

load();
</script>
</body>
</html>